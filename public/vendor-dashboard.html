<!DOCTYPE html>
<html>
<head>
    <title>Vendor Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-4">
    <h3>Vendor Dashboard</h3>

    <div class="card p-3 mb-4">
        <h5>Add Product</h5>
        <input class="form-control mb-2" id="name" placeholder="Product Name">
        <input class="form-control mb-2" id="description" placeholder="Description">
        <input class="form-control mb-2" id="price" placeholder="Price">
        <input class="form-control mb-2" id="quantity" placeholder="Quantity">
        <button class="btn btn-primary" onclick="addProduct()">Add</button>
    </div>

    <h5>Your Products</h5>
    <div id="products"></div>

    <button class="btn btn-danger mt-3" onclick="logout()">Logout</button>
</div>

<script>
const token = localStorage.getItem("token");

async function addProduct(){
    await fetch("/api/products/add",{
        method:"POST",
        headers:{
            "Content-Type":"application/json",
            "Authorization":token
        },
        body:JSON.stringify({
            name:name.value,
            description:description.value,
            price:price.value,
            quantity:quantity.value
        })
    });
    alert("Added!");
    loadProducts();
}

async function loadProducts(){
    const res = await fetch("/api/products/vendor-products",{
        headers:{ "Authorization":token }
    });

    const data = await res.json();

    let output="";
    data.forEach(p=>{
        output += `<div class="card p-2 mb-2">
            ${p.name} - â‚¹${p.price}
        </div>`;
    });

    products.innerHTML=output;
}

function logout(){
    localStorage.clear();
    location="login.html";
}

loadProducts();
</script>

</body>
</html>
