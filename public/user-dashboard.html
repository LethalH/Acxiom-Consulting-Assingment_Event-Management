<!DOCTYPE html>
<html>
<head>
    <title>User Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<nav class="navbar navbar-dark bg-dark p-3">
    <span class="navbar-brand">User Dashboard</span>
    <div>
        <a href="cart.html" class="btn btn-warning">Cart</a>
        <button class="btn btn-danger" onclick="logout()">Logout</button>
    </div>
</nav>

<div class="container mt-4">
    <div class="row" id="products"></div>
</div>

<script>
const token = localStorage.getItem("token");

async function loadProducts(){
    const res = await fetch("/api/products/all");
    const products = await res.json();

    let output = "";
    products.forEach(p=>{
        output += `
        <div class="col-md-4 mb-3">
            <div class="card p-3">
                <h5>${p.name}</h5>
                <p>â‚¹${p.price}</p>
                <button class="btn btn-primary" onclick="addToCart(${p.id})">Add</button>
            </div>
        </div>`;
    });

    productsDiv.innerHTML = output;
}

async function addToCart(id){
    await fetch("/api/cart/add",{
        method:"POST",
        headers:{
            "Content-Type":"application/json",
            "Authorization":token
        },
        body:JSON.stringify({product_id:id,quantity:1})
    });
    alert("Added to cart");
}

function logout(){
    localStorage.clear();
    location="login.html";
}

loadProducts();
</script>

</body>
</html>
